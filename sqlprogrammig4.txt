CREATE TABLE AUTHOR
(
 AUTHORID NUMBER(5),
 ANAME VARCHAR(15),
 ACITY VARCHAR2(15),
 ACOUNTRY VARCHAR(15),
 PRIMARY KEY(AUTHORID)
);

CREATE TABLE PUBLISHER
(
 PUBLISHERID NUMBER(5),
 PNAME VARCHAR(15),
 PCITY VARCHAR2(15),
 PCOUNTRY VARCHAR(15),
 PRIMARY KEY(PUBLISHERID)
 );

CREATE TABLE CATEGORY
(
 CATEGORYID NUMBER(5),
 DESCRIPTION VARCHAR(15),
 PRIMARY KEY(CATEGORYID)
 ); 

 CREATE TABLE CATALOG
 (
  BOOKID NUMBER(5),
 TITLE VARCHAR2(15),
 AUTHORID NUMBER(5),
 PUBLISHERID NUMBER(5),
 CATEGORYID NUMBER(5),
 YEAR NUMBER(5),
 PRICE NUMBER(10,3),
 PRIMARY KEY(BOOKID),
 FOREIGN KEY(AUTHORID) REFERENCES AUTHOR(AUTHORID),
 FOREIGN KEY(PUBLISHERID) REFERENCES PUBLISHER(PUBLISHERID),
 FOREIGN KEY(CATEGORYID) REFERENCES CATEGORY(CATEGORYID)
 );

 CREATE TABLE ORDER_DETAILS
 (
  ORDERNO NUMBER(5),
  BOOKID NUMBER(5),
 QUANTITY NUMBER(5),
 PRIMARY KEY(ORDERNO,BOOKID),
 FOREIGN KEY(BOOKID) REFERENCES CATALOG(BOOKID)
 );
INSERT INTO AUTHOR  VALUES(&AUTHORID,'&ANAME','&ACITY','&ACOUNTRY');
INSERT INTO PUBLISHER VALUES(&PUBLISHERID,'&PNAME','&PCITY','&PCOUNTRY');
INSERT INTO CATEGORY VALUES(&CATEGORYID,'&DESCRIPTION');
INSERT INTO CATALOG VALUES (&BOOKID,'&TITLE',&AUTHORID,&PUBLISHERID,&CATEGORYID,&YEAR, &PRICE);
INSERT INTO ORDER_DETAILS VALUES(&ORDERNO,&BOOKID,&QUANTITY);
commit;
select * from author; 
select* from publisher;
select* from category;
select* from CATALOG;
Select * from ORDER_DETAILS;
SELECT * FROM AUTHOR A WHERE A.AUTHORID IN
 (SELECT C.AUTHORID FROM CATALOG C 
WHERE
 	                    C.PRICE >
                           		(SELECT AVG(PRICE) FROM CATALOG)
 	                  		 AND 
                           		 C.YEAR>=2000
                            		 GROUP BY C.AUTHORID HAVING COUNT(*)>=2);
                                     
                                     
SELECT ANAME FROM AUTHOR WHERE AUTHORID IN
  (
   SELECT AUTHORID FROM CATALOG WHERE BOOKID IN
  (
   SELECT BOOKID FROM ORDER_DETAILS GROUP BY BOOKID HAVING SUM(QUANTITY)>=ALL
  (
     SELECT  SUM(QUANTITY) FROM ORDER_DETAILS GROUP BY BOOKID
  )
)
);

  UPDATE CATALOG SET PRICE=PRICE+PRICE*0.10  WHERE PUBLISHERID IN (SELECT P.PUBLISHERID FROM PUBLISHER P  WHERE P.PNAME='&PNAME');

                                    
                                     
